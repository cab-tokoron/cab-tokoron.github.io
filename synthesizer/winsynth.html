<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <div id="freq"></div>
    <div id="volume"></div>
    <button id="start">start</button>
    <script>
        var volume = 0;
        var octave = 4;
        const frqInfo = document.getElementById("freq");
        const volInfo = document.getElementById("volume");
        window.AudioContext = window.AudioContext || window.webkitAudioContext;
        //const ctx = new AudioContext();
        let gainNode;
        let osc;

        document.getElementById("start").addEventListener("click", ()=>{
            ctx = new AudioContext();
            gainNode = ctx.createGain();
            gainNode.gain.value = volume;
            osc = ctx.createOscillator();
            osc.type = "sine";
            osc.frequency.value = 523.251 * 2**(octave-2);
            osc.connect(gainNode).connect(ctx.destination);
            osc.start();
        },false);

        window.addEventListener("deviceorientation",(e)=>{
            let curVol = Math.min(Math.abs(e.gamma),40.0)/40.0;
            let curOct = Math.min(Math.trunc(e.beta/10),4);
            if (curOct!=octave){
                osc.frequency.value = 523.251 * 2**(octave-2);
                frqInfo.innerHTML = "Frq: " + osc.frequency.value.toFixed(2) + "Hz";
            }
            if (curVol!=volume){
                gainNode.gain.value = volume;
                volInfo.innerHTML = "Vol: " + volume.toFixed(2);
            }
            volume = curVol;
            octave = curOct;
        }, false);
    </script>
</body>
</html>